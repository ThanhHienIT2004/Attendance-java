package app;

import javafx.application.Application;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.TextField;
import javafx.scene.layout.GridPane;
import javafx.stage.Stage;
import model.Student;
import controller.FaceDetect;

public class AddStudent extends Application {

    private TextField idField;
    private TextField nameField;
    private TextField classField;
    private FaceDetect faceDetect; // Đối tượng FaceDetect

    @Override
    public void start(Stage primaryStage) {
        // Tạo các trường nhập liệu
        idField = new TextField();
        nameField = new TextField();
        classField = new TextField();

        // Tạo nút thêm sinh viên
        Button addButton = new Button("Thêm sinh viên");
        addButton.setOnAction(e -> addStudent());

        // Tạo giao diện
        GridPane grid = new GridPane();
        grid.setHgap(10);
        grid.setVgap(10);
        grid.add(new Label("Mã số sinh viên:"), 0, 0);
        grid.add(idField, 1, 0);
        grid.add(new Label("Tên sinh viên:"), 0, 1);
        grid.add(nameField, 1, 1);
        grid.add(new Label("Lớp sinh viên:"), 0, 2);
        grid.add(classField, 1, 2);
        grid.add(addButton, 1, 3);

        Scene scene = new Scene(grid, 300, 200);
        primaryStage.setScene(scene);
        primaryStage.setTitle("Thêm Sinh Viên");
        primaryStage.show();
    }

    private void addStudent() {
        try {
            // Nhập thông tin sinh viên từ các trường
            int id = Integer.parseInt(idField.getText());
            String name = nameField.getText();
            String studentClass = classField.getText();

            // Tạo đối tượng Student
            Student student = new Student(id, name, studentClass, null);

            // Khởi tạo và chạy FaceDetect để chụp ảnh
            faceDetect = new FaceDetect();
            faceDetect.detectFace(student);

            // Hiển thị thông tin sinh viên
            student.displayStudentInfo();

            // Làm sạch các trường nhập liệu sau khi thêm
            idField.clear();
            nameField.clear();
            classField.clear();
        } catch (NumberFormatException e) {
            System.out.println("Mã số sinh viên không hợp lệ.");
        } catch (Exception e) {
            System.out.println("Có lỗi xảy ra: " + e.getMessage());
        }
    }

    public static void main(String[] args) {
        launch(args);
    }
}
